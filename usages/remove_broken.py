#!/usr/bin/env python
# -*- coding: utf-8 -*-
import argparse
import logging
import os

BROKEN_LIST = {'866': ['NP_001265354.1'], '2694': ['NP_001358973.1', 'XP_022280594.1'], '3225': ['NP_055059.2'], '2061': ['NP_002727.2'], '2682': ['NP_001335218.1'], '4158': ['NP_116199.2'], '2698': ['NP_056046.1', 'XP_011285146.2'], '2708': ['NP_066273.1'], '4129': ['NP_001229601.2'], '5186': ['NP_563578.2'], '3651': ['NP_001165102.1'], '2813': ['NP_066288.2'], '4253': ['NP_001311049.1'], '908': ['NP_000622.2', 'XP_003989283.1'], '3504': ['YP_003024027.1', 'NP_008472.4', 'NP_008252.1', 'YP_001874854.1', 'NP_941379.1'], '3509': ['YP_003024032.1', 'NP_008477.4', 'NP_008257.1', 'YP_001874859.1', 'NP_941384.1'], '3510': ['YP_003024033.1', 'NP_008478.4', 'NP_941385.1'], '3502': ['YP_003024035.1', 'NP_008480.1', 'NP_008260.1', 'YP_001874862.1', 'NP_941387.1'], '3514': ['YP_003024038.1'], '985': ['XP_852048.2', 'XP_007099303.1'], '405': ['XP_533481.3'], '2036': ['XP_022283620.1'], '2795': ['XP_022261043.1'], '4289': ['XP_541562.3'], '2614': ['XP_022261796.1'], '174': ['XP_005616768.2'], '131': ['XP_022264832.1'], '1255': ['XP_003433811.1'], '3742': ['NP_001003195.1'], '2810': ['XP_544528.5'], '2391': ['XP_005618474.1'], '3257': ['XP_013968181.1'], '848': ['XP_013968185.1', 'XP_023096163.1'], '3691': ['NP_001003057.1', 'XP_006928053.2'], '2115': ['XP_536477.3'], '3997': ['XP_013968272.1'], '2626': ['XP_022273769.1'], '1136': ['XP_546487.3'], '767': ['XP_848597.2'], '1201': ['NP_001238871.1'], '2075': ['XP_003639083.2', 'XP_015394673.1'], '1944': ['XP_005622128.1'], '1747': ['XP_013970147.1'], '4113': ['XP_022275971.1'], '1480': ['XP_005642532.1'], '487': ['XP_547238.5'], '1004': ['XP_013970474.1', 'XP_026930231.1'], '2421': ['XP_013970643.1'], '1245': ['XP_013970485.1'], '3367': ['XP_013971089.2'], '1591': ['XP_022277560.1'], '5009': ['XP_022278207.1', 'XP_019688491.2'], '3394': ['NP_001003170.1'], '341': ['XP_852848.2'], '950': ['NP_001003114.1'], '450': ['NP_001091028.1'], '724': ['NP_001002978.1', 'XP_007099260.2'], '3100': ['XP_013971955.1'], '3221': ['XP_548087.3'], '2072': ['XP_013971957.1'], '5650': ['NP_001008717.1'], '71': ['XP_022279645.1'], '3534': ['XP_013972582.1'], '134': ['XP_003639383.1'], '4834': ['XP_022279960.1'], '239': ['XP_022279959.1'], '567': ['XP_022280010.1'], '3098': ['XP_022280439.1'], '4431': ['NP_001003232.1'], '1652': ['XP_013973302.1'], '3687': ['XP_013973425.1', 'XP_006939454.2'], '1588': ['XP_003639465.3', 'XP_014928992.2'], '4312': ['XP_013973859.1'], '1075': ['XP_005627322.1', 'XP_023109673.1', 'XP_026913701.1'], '1390': ['XP_022281498.1'], '3229': ['XP_867464.3', 'XP_003986364.2', 'XP_014933688.2'], '4091': ['XP_022282821.1'], '340': ['XP_022282225.1', 'XP_015397244.1'], '829': ['XP_022282758.1'], '3560': ['XP_013974367.2', 'XP_015397869.1'], '937': ['XP_022282985.1', 'XP_004001342.2', 'XP_007099151.2'], '2972': ['XP_851676.3'], '637': ['XP_022283389.1'], '3500': ['XP_005642517.2'], '1195': ['XP_005629977.2'], '5266': ['XP_532819.3'], '2687': ['NP_001003314.1'], '1418': ['NP_001003366.1'], '569': ['NP_001129118.1'], '2135': ['XP_852590.2', 'XP_003984200.4', 'XP_007083545.1', 'XP_014942538.1'], '3457': ['XP_848464.2'], '2292': ['XP_540756.3'], '4059': ['XP_022261458.1'], '1491': ['XP_533270.4'], '3451': ['XP_005642519.1'], '2602': ['NP_001003315.1'], '4259': ['XP_533782.3'], '1980': ['XP_022262659.1'], '251': ['XP_533902.3', 'XP_003981968.2', 'XP_007098221.2', 'XP_026906353.1'], '1589': ['XP_013977294.1'], '1767': ['NP_001182763.1'], '4835': ['XP_534037.4'], '1533': ['XP_005633784.1', 'XP_003993081.1', 'XP_026928828.1'], '731': ['XP_005633871.1'], '167': ['XP_534094.4'], '4267': ['XP_855389.3'], '889': ['XP_005633935.1', 'XP_026920632.1'], '4682': ['XP_542573.3'], '2121': ['XP_022264057.1'], '2592': ['XP_005634010.1'], '1472': ['XP_003639867.1'], '2640': ['XP_022264756.1'], '2254': ['NP_001239297.1'], '3459': ['XP_854302.2'], '2337': ['XP_854633.3', 'XP_023097382.1', 'XP_026906721.1'], '455': ['XP_543677.4'], '3218': ['XP_003640009.1', 'XP_003988690.2'], '2923': ['XP_005637491.1', 'XP_011282095.2'], '2457': ['XP_022267095.1'], '658': ['XP_013964246.1'], '2091': ['XP_850948.2', 'XP_007080198.1', 'XP_026918563.1'], '12': ['XP_543955.3'], '3294': ['XP_851823.2'], '445': ['XP_013964618.2'], '4695': ['XP_013964892.1'], '3177': ['XP_013964830.2'], '1974': ['XP_535425.3'], '817': ['XP_013964852.2'], '223': ['NP_001002990.1'], '5322': ['XP_022269141.1'], '1989': ['NP_001091010.1'], '403': ['NP_001161932.1'], '881': ['NP_001238873.1'], '4712': ['XP_022270174.1'], '1632': ['XP_005642504.1'], '5069': ['XP_013966268.1'], '3955': ['NP_001003126.1'], '3648': ['XP_005642146.2'], '2869': ['XP_013967149.1'], '3028': ['XP_003435654.2'], '384': ['XP_003980337.2'], '2872': ['XP_023108139.1'], '2525': ['XP_003980702.2'], '4333': ['XP_023111378.1'], '2949': ['XP_019694730.2'], '304': ['XP_023116198.1'], '3671': ['XP_023098639.1', 'XP_007075794.1'], '2439': ['XP_003981769.2'], '5103': ['XP_023101897.1'], '2727': ['XP_023106242.1'], '1775': ['XP_011278855.1'], '4268': ['XP_011278830.1'], '3698': ['XP_011278942.1'], '1175': ['XP_006930067.2'], '1009': ['NP_001009840.1'], '900': ['XP_003984966.1'], '1002': ['XP_003984971.3'], '2204': ['XP_003984978.2'], '1712': ['XP_023108669.1'], '4169': ['XP_023108797.1'], '4760': ['XP_011280191.1'], '2410': ['XP_023109107.1'], '5581': ['XP_023109262.1'], '2444': ['XP_023110405.1', 'XP_007099132.1'], '5630': ['XP_023109844.1'], '3631': ['XP_023109949.1', 'XP_007076993.1'], '5212': ['XP_011280759.2'], '2864': ['XP_011280838.1', 'XP_015394503.1', 'XP_014932112.1'], '1147': ['XP_011280827.2'], '1833': ['XP_003986523.3', 'XP_007078846.1', 'XP_014920853.1'], '4633': ['XP_006932144.1'], '4963': ['XP_011280872.2'], '5016': ['XP_023110702.1'], '5273': ['XP_023110801.1'], '77': ['XP_003987087.1'], '3232': ['XP_003987155.2'], '2147': ['XP_023111193.1'], '4780': ['XP_023111936.1'], '1953': ['XP_003987585.2'], '3383': ['XP_023111423.1'], '2018': ['XP_023111488.1', 'XP_015396110.1'], '2140': ['XP_023111505.1'], '5810': ['XP_023111524.1'], '3675': ['XP_006933374.3', 'XP_014921783.2'], '1705': ['XP_023112326.1'], '4520': ['XP_003988381.2'], '2260': ['XP_023113507.1'], '2008': ['XP_023112516.1'], '1991': ['XP_003988472.1'], '651': ['XP_003989222.2'], '4162': ['XP_023113681.1'], '357': ['XP_019694603.1', 'XP_015393619.1', 'XP_026914021.1'], '1721': ['XP_003989706.3'], '2464': ['XP_023114401.1', 'XP_026915131.1'], '4819': ['XP_023114535.1'], '1401': ['XP_023114563.1', 'XP_015396442.1', 'XP_026914729.1'], '4388': ['XP_003990526.2'], '1349': ['XP_011283468.2'], '608': ['XP_023114907.1'], '543': ['XP_023115195.1'], '299': ['XP_011283618.1'], '4916': ['XP_023115243.1'], '5106': ['XP_003990935.1'], '3980': ['XP_006935459.2'], '1838': ['XP_011284070.2'], '2868': ['XP_019695041.2'], '1302': ['XP_023094655.1'], '3054': ['XP_003991682.1'], '5346': ['XP_006944301.2'], '2301': ['XP_006944298.1'], '5268': ['XP_019666037.1'], '853': ['XP_023116228.1'], '5239': ['XP_019666124.1'], '430': ['XP_003992247.1'], '103': ['XP_019668480.1'], '4765': ['XP_003992648.2'], '1275': ['XP_003992943.1'], '5697': ['XP_003992924.3'], '4327': ['XP_004001230.2'], '5502': ['XP_003993152.3'], '3431': ['XP_003993399.2'], '4804': ['XP_003993459.2'], '3270': ['XP_003993463.1'], '440': ['XP_023095529.1'], '230': ['XP_003993973.2'], '1790': ['XP_023096217.1'], '2472': ['XP_003994019.3'], '355': ['XP_006937930.1'], '4182': ['XP_003994177.2'], '419': ['XP_023096395.1'], '714': ['XP_019669129.2', 'XP_015392147.1'], '3292': ['XP_011285902.2'], '5232': ['XP_023097020.1', 'XP_015395444.1'], '244': ['XP_023097283.1'], '4788': ['XP_023097928.1', 'XP_015397201.1'], '1819': ['XP_011286282.1'], '2710': ['XP_003995198.1', 'XP_007081865.1'], '3711': ['NP_001122314.1'], '2709': ['XP_023099034.1'], '2074': ['XP_023099038.1'], '1777': ['XP_011286630.1', 'XP_015400405.1'], '980': ['XP_003995573.2'], '3871': ['XP_023098337.1'], '2449': ['XP_003996021.1'], '4755': ['XP_023098628.1', 'XP_015391538.1'], '270': ['XP_003996803.3', 'XP_007085804.1', 'XP_014934024.1'], '1031': ['XP_003996889.2'], '5086': ['XP_006940406.1', 'XP_015395506.1'], '3917': ['XP_011287441.2'], '3664': ['XP_006940407.2'], '2053': ['XP_006940478.3'], '183': ['XP_023099244.1'], '2998': ['XP_003997297.2'], '469': ['XP_023100029.1'], '764': ['XP_003997336.1'], '2507': ['XP_023101631.1'], '4825': ['XP_023101654.1'], '1660': ['XP_003997747.1'], '198': ['XP_023101043.1'], '2648': ['XP_011288197.2', 'XP_026893392.1'], '213': ['XP_019674382.1', 'XP_026900650.1'], '488': ['XP_023101469.1'], '148': ['XP_003998090.1'], '1061': ['XP_003998100.2'], '5573': ['XP_023100889.1', 'XP_007075008.2'], '923': ['XP_011288736.2'], '5162': ['NP_001233207.1'], '2937': ['XP_003998767.1', 'XP_007084128.1'], '2309': ['XP_023102848.1'], '1903': ['XP_023102198.1'], '4545': ['XP_003998944.2'], '3747': ['XP_003999078.2'], '830': ['XP_019676848.1'], '4562': ['XP_023103263.1'], '1845': ['XP_019677134.2'], '4331': ['NP_001073297.1'], '763': ['XP_003999648.1'], '2831': ['XP_019676936.2', 'XP_015393934.1', 'XP_014940861.2'], '4935': ['XP_003999861.1'], '3019': ['XP_023104083.1'], '1818': ['XP_011289812.1'], '4941': ['XP_011290031.2'], '4814': ['XP_023104722.1'], '5362': ['XP_011277693.1'], '1396': ['XP_007073143.1'], '433': ['XP_015398431.1'], '5485': ['XP_015398519.1'], '4069': ['XP_007073163.1'], '1045': ['XP_015390594.1'], '576': ['XP_015391249.1'], '5207': ['XP_015391440.1'], '1406': ['XP_007073479.1'], '630': ['XP_007073659.1'], '1144': ['XP_007073766.1'], '102': ['XP_015393568.1'], '162': ['XP_007099343.1'], '3537': ['XP_015394305.1', 'XP_014929506.2'], '5575': ['XP_007074153.1'], '4118': ['XP_007074310.1'], '3799': ['XP_015394644.1'], '2825': ['XP_007099497.1'], '5614': ['XP_015398311.1'], '3878': ['XP_007075196.1'], '5316': ['XP_015399639.1'], '1226': ['XP_007075533.1'], '2297': ['XP_007075957.1'], '1296': ['XP_007099305.2'], '4376': ['XP_007076082.1'], '1751': ['XP_007076111.1'], '2316': ['XP_007099378.1'], '3037': ['XP_007076448.2', 'XP_014931350.2'], '2496': ['XP_015390477.1'], '1117': ['XP_015390452.1'], '5837': ['XP_015390544.1'], '1467': ['XP_007076689.1'], '2345': ['XP_007099167.1'], '3070': ['XP_007076917.1'], '1182': ['XP_007077005.1'], '1414': ['XP_007099148.1'], '4177': ['XP_015390839.1'], '5730': ['XP_007077498.1'], '5806': ['XP_015390973.1'], '2311': ['XP_007078011.1'], '2544': ['XP_015391140.1'], '3829': ['XP_015391219.1'], '2488': ['XP_007099345.1'], '2504': ['XP_007099284.1'], '1419': ['XP_007099202.1'], '1684': ['XP_007078951.1', 'XP_014935933.1'], '5537': ['XP_007099450.1'], '888': ['XP_015391786.1'], '417': ['XP_007079402.2'], '422': ['XP_007079459.1'], '143': ['XP_007079720.2'], '1481': ['XP_007079764.1'], '1394': ['XP_015391971.1'], '571': ['XP_007099397.1'], '3979': ['XP_007079856.1'], '4005': ['XP_007079949.1'], '26': ['XP_007080001.1'], '3851': ['XP_015392132.1'], '458': ['XP_007080192.1'], '2575': ['XP_015392156.1'], '475': ['XP_007080238.1'], '1866': ['XP_015392296.1'], '5170': ['XP_015392390.1'], '3199': ['XP_007080801.1'], '4326': ['XP_007080790.1'], '5380': ['XP_015392437.1'], '4491': ['NP_001277531.1'], '4246': ['XP_015392466.1'], '2799': ['XP_007099381.1'], '4401': ['XP_015392531.1'], '840': ['XP_007081418.1'], '918': ['XP_015392702.1'], '924': ['XP_007099159.2'], '2718': ['XP_015392711.1'], '5586': ['XP_015392778.1'], '2073': ['XP_007081705.1'], '5010': ['XP_007081805.1'], '3142': ['XP_007081895.2'], '634': ['XP_007081984.1'], '4471': ['XP_007082131.1'], '3380': ['XP_007082270.1'], '4328': ['XP_015393074.1'], '4156': ['XP_015393209.1'], '5734': ['XP_007099310.2'], '19': ['XP_007083086.1'], '4188': ['XP_015393432.1'], '5128': ['XP_007083750.1'], '1851': ['XP_015393730.1'], '217': ['XP_007084148.1'], '211': ['XP_007084170.1'], '4516': ['XP_015393950.1'], '4674': ['XP_015394075.1'], '1157': ['XP_007085033.1'], '2681': ['XP_007085095.1'], '5488': ['XP_007085133.2'], '3581': ['XP_007099257.1'], '520': ['XP_015394467.1'], '1627': ['XP_015394487.1'], '495': ['XP_007099472.1'], '2031': ['XP_007086124.1'], '1085': ['XP_007086435.1', 'XP_014927955.2'], '255': ['XP_015394838.1'], '1300': ['XP_007099434.2', 'XP_026910918.1'], '521': ['XP_015394901.1', 'XP_026930890.1'], '3860': ['XP_015395001.1'], '4832': ['XP_015395061.1'], '3489': ['XP_007086835.1'], '619': ['XP_007086771.1'], '3278': ['XP_007086951.1'], '4992': ['XP_007087649.1'], '1395': ['XP_007087704.2'], '4145': ['XP_015395502.1'], '4931': ['XP_007087783.2', 'XP_026904780.1'], '2910': ['XP_007087745.1'], '5441': ['XP_007088248.1'], '1739': ['XP_007088510.1'], '3773': ['XP_007088755.2'], '327': ['XP_007088760.1'], '5238': ['XP_015395939.1'], '2586': ['XP_007088796.1'], '2403': ['XP_007099158.1'], '3730': ['XP_007089244.1'], '3528': ['XP_015396179.1'], '3729': ['XP_007089281.1'], '4171': ['XP_007089381.1'], '2790': ['XP_007089871.1'], '3407': ['XP_007089873.1'], '4637': ['XP_007090173.1'], '1915': ['XP_015396660.1'], '383': ['XP_015396593.1'], '3907': ['XP_007090330.1'], '3629': ['XP_015396722.1'], '1924': ['XP_015396760.1'], '3869': ['XP_015396823.1'], '448': ['XP_015397066.1'], '758': ['XP_007091362.1'], '1616': ['XP_015397144.1'], '4260': ['XP_015397216.1'], '1578': ['XP_015397227.1'], '2159': ['XP_007091670.1'], '1163': ['XP_007091718.1'], '1876': ['XP_007091907.1'], '460': ['XP_015397432.1'], '1658': ['XP_015397461.1'], '1483': ['XP_015397463.1'], '4581': ['XP_015397622.1'], '5704': ['XP_015397808.1'], '4371': ['XP_007092902.2'], '4411': ['XP_007092905.2'], '4868': ['XP_015397995.1'], '2726': ['XP_007099482.2'], '2453': ['XP_007099362.1'], '3915': ['XP_015398223.1'], '3609': ['XP_015398340.1'], '2692': ['XP_015398347.1'], '434': ['XP_015398426.1'], '1357': ['XP_007094655.2'], '2783': ['XP_015398696.1'], '4426': ['XP_007094826.1'], '3592': ['XP_007094958.1'], '2361': ['XP_007095330.1'], '1391': ['XP_007095145.1'], '2189': ['XP_007095389.2'], '2680': ['XP_007095448.1'], '1128': ['XP_007099146.1'], '1759': ['XP_015398983.1'], '2247': ['NP_001277549.1'], '549': ['XP_007096561.2'], '930': ['XP_007096523.1'], '1003': ['XP_007099289.1'], '4011': ['XP_007096696.1'], '4907': ['XP_007096739.1'], '719': ['XP_007099162.1'], '3393': ['XP_007099309.1'], '4377': ['XP_007097284.1'], '4898': ['XP_015399789.1'], '2818': ['XP_015400060.1'], '4656': ['XP_007097949.1'], '1054': ['XP_007097918.1'], '3787': ['XP_007098062.2', 'XP_026921248.1'], '810': ['XP_007099413.2'], '164': ['XP_007098527.1'], '402': ['XP_015400367.1'], '2334': ['XP_007099175.1'], '1800': ['XP_015400386.1'], '5694': ['XP_015400447.1'], '36': ['XP_015400485.1'], '5580': ['XP_015400578.1'], '969': ['XP_007098934.1'], '1194': ['XP_015400663.1'], '4773': ['XP_026913532.1'], '4167': ['XP_014937189.2'], '4980': ['XP_026913929.1'], '5574': ['XP_026914117.1'], '2684': ['XP_026914129.1'], '2637': ['XP_014921662.2'], '2474': ['XP_026914251.1'], '4050': ['XP_026914010.1'], '1449': ['XP_014938337.2'], '3235': ['XP_014937747.2'], '3110': ['XP_014918536.2'], '4433': ['XP_026920981.1'], '1235': ['XP_026923870.1'], '1888': ['XP_026924483.1'], '633': ['XP_014926635.2'], '3921': ['XP_026926518.1'], '2409': ['XP_026926121.1'], '2327': ['XP_026928243.1'], '2757': ['XP_014939834.2'], '1336': ['XP_026930000.1'], '2470': ['XP_014924643.2'], '5082': ['XP_026891352.1'], '3536': ['XP_014929507.1'], '824': ['XP_026893344.1'], '2792': ['XP_026893389.1'], '1464': ['XP_026895182.1'], '4353': ['XP_026897674.1'], '2289': ['XP_014933188.2'], '1791': ['XP_026901868.1'], '3951': ['XP_014939270.2'], '2599': ['XP_014940883.2'], '2854': ['XP_026906468.1'], '160': ['XP_014917755.2'], '226': ['XP_014932366.2'], '3236': ['XP_014937089.1'], '5198': ['XP_026907707.1'], '1856': ['XP_014917671.2'], '4172': ['XP_014917569.2']}
NOT_FOUND_FILES = list()


def replace_broken_files(directory_out):
    global NOT_FOUND_FILES
    broken_multiple_folder = "broken_multiple_files"
    if not os.path.isdir(directory_out):
        os.makedirs(broken_multiple_folder)
    try:
        for file_number in BROKEN_LIST.keys():
            os.replace(os.path.join(directory_out, file_number + ".fna"), os.path.join(broken_multiple_folder, file_number + ".fna"))
            os.replace(os.path.join(directory_out, file_number + ".log"), os.path.join(broken_multiple_folder, file_number + ".log"))
            logging.info("Replaced all from BROKEN_LIST to the folder {}".format(broken_multiple_folder))
    except FileNotFoundError:
        if file_number not in NOT_FOUND_FILES:
            NOT_FOUND_FILES.append(file_number)


def main(outfolder):
    replace_broken_files(outfolder)


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--outfolder', help='Path to the folder with broken files', nargs='?')
    args = parser.parse_args()
    try:
        main(args.outfolder)
    except:
        logging.exception("Unexpected error")
    logging.info("NOT_FOUND_FILES list of length {}:\n{}".format(len(NOT_FOUND_FILES), NOT_FOUND_FILES))


